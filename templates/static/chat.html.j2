{% set this_page = "chat" %}
{% extends "templates/static/layout.html.j2" %}

{% block title %}Chat{% endblock %}

{% block content %}
<div class="container pt-3">
<h5>Chat</h5>
<div class="table-responsive">
  <table class="table table-striped table-bordered">
    <thead>
      <tr>
        <th scope="col">Time</th>
        <th scope="col">From</th>
        <th scope="col">To</th>
        <th scope="col">Message</th>
      </tr>
    </thead>
    <tbody>
      {% for message in chat['channels']["8"]['messages'] %}
      <tr>
        <td>{{ datetime.fromtimestamp(message.timestamp).astimezone(zoneinfo).strftime('%Y-%m-%d %H:%M:%S') }}</td>
        {% if message["from"] in nodes %}
        <td><a href="node_{{ message['from'] }}.html">{{ nodes[message["from"]].longname+" (" + nodes[message["from"]].shortname + ")" }}</a></td>
        {% else %}
        <td>{{ message["from"] }}</td>
        {% endif %}
        {% if message["to"] in nodes and message["to"] != "ffffffff" %}
        <td><a href="node_{{ message['to'] }}.html">{{ nodes[message["to"]].longname+" (" + nodes[message["to"]].shortname + ")" }}</a></td>
        {% else %}
        <td>{{ message["to"] if message["to"] != "ffffffff" else "ALL"}}</td>
        {% endif %}
        <td>{{ message["text"] }}</td>
      </tr>
      {% endfor %}
    </tbody>
</div>
</div>
{% endblock %}